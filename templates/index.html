<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WWM Vi·ªát H√≥a & Donate</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f8f9fa; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        /* Hero Section */
        .hero { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 60px 0; margin-bottom: 30px; }
        .hero-donate { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: #333; padding: 50px 0; border-radius: 20px; margin-top: 50px;}
        
        /* Card Styles */
        .card-version { transition: transform 0.2s; border: none; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .card-version:hover { transform: translateY(-3px); }
        
        /* Pricing Table Styles */
        .pricing-card { border: none; border-radius: 15px; transition: all 0.3s; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .pricing-card:hover { transform: translateY(-10px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        .pricing-header { padding: 30px 20px; border-radius: 15px 15px 0 0; }
        .popular-badge { position: absolute; top: 0; right: 0; background: #ff4757; color: white; padding: 5px 15px; border-radius: 0 15px 0 15px; font-weight: bold; font-size: 0.9rem; }
        .feature-list li { padding: 10px 0; border-bottom: 1px dashed #eee; }
        .feature-list li:last-child { border-bottom: none; }
        
        /* Steps */
        .step-box { background: white; padding: 20px; border-radius: 10px; border-left: 5px solid #0d6efd; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .hidden { display: none !important; }
        
        /* Stats */
        .stat-box { text-align: center; padding: 20px; }
        .stat-number { font-size: 2.5rem; font-weight: bold; color: #d63384; }
        
        /* Top Donors Banner */
        .marquee {
            overflow: hidden;
            box-sizing: border-box;
            position: relative;
            background: linear-gradient(to right, #ffd700, #ffa500, #ffd700);
            padding: 10px 0;
            white-space: nowrap;
        }
        
        .marquee-content {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 15s linear infinite;
        }
        
        .marquee-content:hover {
            animation-play-state: paused;
        }
        
        @keyframes marquee {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }
        
        .donor-highlight {
            display: inline-block;
            margin: 0 15px;
            font-weight: bold;
            color: #8b0000;
        }
        
        .donor-rank {
            background: #8b0000;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div id="topDonorsBanner" class="marquee d-none">
        <div class="marquee-content" id="marqueeContent">
            </div>
    </div>

    <div class="hero text-center">
        <div class="container">
            <h1><i class="fa-solid fa-dragon"></i> Where Winds Meet - Vi·ªát H√≥a - Edit Font</h1>
            <p class="lead">Trang chuy√™n t·∫£i Vi·ªát H√≥a Game WWM v√† C√¥ng C·ª• Ch·ªânh Font</p>
            <div class="mt-4">
                <a href="#download-section" class="btn btn-light btn-lg me-2"><i class="fa-solid fa-download"></i> T·∫£i Vi·ªát H√≥a</a>
                <a href="/tutorial" class="btn btn-info btn-lg fw-bold shadow me-2 text-white">
                    <i class="fa-solid fa-book"></i> H∆∞·ªõng D·∫´n
                </a>
                <a href="/tools/font-editor" class="btn btn-warning btn-lg fw-bold shadow me-2">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> C√¥ng C·ª• Font
                </a>
                <a href="#donate-section" class="btn btn-outline-light btn-lg"><i class="fa-solid fa-heart"></i> Nu√¥i T√¥i</a>
            </div>
        </div>
    </div>

    <div class="container" style="max-width: 960px;">
        
        <section id="download-section" class="mb-5">
            <h2 class="text-center mb-4 text-primary"><i class="fa-solid fa-cloud-arrow-down"></i> T·∫¢I B·∫¢N VI·ªÜT H√ìA</h2>
            
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label fw-bold">N·ªÅn t·∫£ng:</label>
                            <select id="platformSelect" class="form-select" onchange="filterVersions()">
                                <option value="Launcher">Client NPH (Launcher)</option>
                                <option value="Steam">Steam</option>
                                <option value="Epic">Epic Games</option>
                            </select>
                        </div>
                        <div id="launcherOptions" class="col-md-6">
                            <label class="form-label fw-bold">Lo·∫°i Client:</label>
                            <div class="d-flex gap-3 mt-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="clientType" id="typeStandard" value="Standard" checked onchange="filterVersions()">
                                    <label class="form-check-label" for="typeStandard">Standard</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="clientType" id="typeLite" value="Lite" onchange="filterVersions()">
                                    <label class="form-check-label" for="typeLite">Lite</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="versionList">
                {% for item in versions %}
                <div class="card card-version item-row" data-platform="{{ item.platform|trim }}">
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="card-title text-primary"><i class="fa-solid fa-box-open"></i> {{ item.version_name }}</h5>
                                <p class="card-text text-muted small"><i class="fa-regular fa-lightbulb"></i> {{ item.note or 'Ch∆∞a c√≥ ghi ch√∫.' }}</p>
                            </div>
                            <div class="col-md-4 text-end">
                                {% if current_user.is_authenticated %}
                                    {% if 'link_normal' in item and item.link_normal and item.link_normal.lower().startswith('http') %}
                                        <a href="{{ item.link_normal }}" target="_blank" class="btn btn-primary btn-download shadow-sm w-100 mb-2">
                                            <i class="fa-solid fa-download"></i> LINK TH∆Ø·ªúNG
                                        </a>
                                    {% elif 'link' in item and item.link and item.link.lower().startswith('http') %}
                                        <a href="{{ item.link }}" target="_blank" class="btn btn-primary btn-download shadow-sm w-100 mb-2">
                                            <i class="fa-solid fa-download"></i> LINK TH∆Ø·ªúNG
                                        </a>
                                    {% else %}
                                        <button class="btn btn-secondary w-100 disabled mb-2">
                                            <i class="fa-solid fa-ban"></i> {% if 'link_normal' in item %}{{ item.link_normal or 'ƒêang c·∫≠p nh·∫≠t' }}{% else %}ƒêang c·∫≠p nh·∫≠t{% endif %}
                                        </button>
                                    {% endif %}
                                    
                                    {% if current_user.is_donor %}
                                        {% if 'link_vip' in item and item.link_vip and item.link_vip.lower().startswith('http') %}
                                            <a href="{{ item.link_vip }}" target="_blank" class="btn btn-warning btn-download shadow-sm w-100">
                                                <i class="fa-solid fa-crown"></i> LINK VIP
                                            </a>
                                        {% endif %}
                                    {% else %}
                                        <button class="btn btn-outline-warning w-100 disabled" disabled>
                                            <i class="fa-solid fa-lock"></i> D√†nh cho VIP
                                        </button>
                                    {% endif %}
                                {% else %}
                                    <a href="/login" class="btn btn-info w-100 mb-2">
                                        <i class="fa-solid fa-right-to-bracket"></i> ƒêƒÇNG NH·∫¨P ƒê·ªÇ XEM LINK
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div id="noDataAlert" class="alert alert-warning text-center hidden">Hi·ªán ch∆∞a c√≥ link t·∫£i cho phi√™n b·∫£n n√†y.</div>
            
            <div class="accordion mt-4" id="accordionHelp">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseHelp">
                            <i class="fa-solid fa-book me-2"></i> H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t nhanh
                        </button>
                    </h2>
                    <div id="collapseHelp" class="accordion-collapse collapse" data-bs-parent="#accordionHelp">
                        <div class="accordion-body">
                            <ol>
                                <li>T·∫£i file ZIP t∆∞∆°ng ·ª©ng phi√™n b·∫£n game.</li>
                                <li>Gi·∫£i n√©n b·∫±ng WinRAR.</li>
                                <li>Copy th∆∞ m·ª•c <code>wwm_standard</code> (ho·∫∑c lite) v√†o th∆∞ m·ª•c c√†i game.</li>
                                <li>Ch·ªçn <strong>Ghi ƒë√® (Replace)</strong> khi ƒë∆∞·ª£c h·ªèi.</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <hr class="my-5">

        <section id="donate-section">
            <div class="hero-donate text-center mb-5">
                <div class="container">
                    <h1 class="display-4 fw-bold mb-3">üçú NU√îI T√îI</h1>
                    <p class="lead mb-4">D·ª± √°n thi·ªán nguy·ªán cho m·ªôt cu·ªôc s·ªëng t·ªët ƒë·∫πp h∆°n (c·ªßa t√¥i)</p>
                    
                    <div class="row justify-content-center mb-4">
                        <div class="col-8">
                            <p>M·ªói ng√†y tr√¥i qua, t√¥i v·∫´n ƒëang ph·∫£i v·∫≠t l·ªôn v·ªõi chi ph√≠ sinh ho·∫°t, tr√† s·ªØa, Netflix, v√† nh·ªØng b·ªØa ƒÉn c∆°m vƒÉn ph√≤ng ƒë·∫Øt ƒë·ªè. H√£y chung tay c√πng t√¥i ƒë·ªÉ t√¥i c√≥ th·ªÉ s·ªëng m·ªôt cu·ªôc s·ªëng x·ª©ng ƒë√°ng h∆°n!</p>
                        </div>
                    </div>

                    <div class="row justify-content-center g-4">
                        <div class="col-md-4">
                            <div class="bg-white rounded p-3 shadow-sm">
                                <div class="stat-number">1</div>
                                <div class="text-muted">Ng∆∞·ªùi ƒë∆∞·ª£c nu√¥i</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="bg-white rounded p-3 shadow-sm">
                                <div class="stat-number">0</div>
                                <div class="text-muted">Nh√† h·∫£o t√¢m</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="bg-white rounded p-3 shadow-sm">
                                <div class="stat-number">69</div>
                                <div class="text-muted">T·ª∑ ƒë·ªìng m·ª•c ti√™u</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mb-5 align-items-center">
                <div class="col-md-6">
                    <img src="https://media.giphy.com/media/l0Ex6kAKAoFRsFh6M/giphy.gif" class="img-fluid rounded shadow" alt="Funny Money Gif">
                </div>
                <div class="col-md-6">
                    <h3 class="text-primary fw-bold">V·ªÅ t√¥i</h3>
                    <p class="fst-italic text-muted">C√¢u chuy·ªán c·ªßa m·ªôt ng∆∞·ªùi tr·∫ª ƒëang c·∫ßn s·ª± h·ªó tr·ª£ t·ª´ c·ªông ƒë·ªìng</p>
                    <p>Xin ch√†o c√°c <strong>anh ch·ªã nu√¥i</strong> th√¢n m·∫øn! T√¥i l√† m·ªôt ng∆∞·ªùi tr·∫ª ƒë·∫ßy tham v·ªçng, ƒëang s·ªëng t·∫°i th√†nh ph·ªë v·ªõi chi ph√≠ sinh ho·∫°t ng√†y c√†ng cao ng·∫•t ng∆∞·ªüng.</p>
                    <p>T·ª´ nƒÉm 2025, t√¥i ƒë√£ nh·∫≠n ra r·∫±ng: <strong>T·∫°i sao ph·∫£i t·ª± nu√¥i b·∫£n th√¢n khi c√≥ th·ªÉ ƒë·ªÉ ng∆∞·ªùi kh√°c nu√¥i?</strong> ƒê√¢y l√† m·ªôt m√¥ h√¨nh thi·ªán nguy·ªán ho√†n to√†n m·ªõi.</p>
                    <p>V·ªõi ch·ªâ <strong>1,45 tri·ªáu ƒë·ªìng/nƒÉm</strong>, c√°c anh ch·ªã s·∫Ω gi√∫p t√¥i c√≥ ƒë·ªß ti·ªÅn cho tr√† s·ªØa, c∆°m vƒÉn ph√≤ng, Netflix. L∆∞u √Ω: Chi ph√≠ v·∫≠n h√†nh (1 t·ª∑ ƒë·ªìng/nƒÉm) s·∫Ω ƒë∆∞·ª£c l·∫•y t·ª´ l√£i ti·∫øt ki·ªám, kh√¥ng tr√≠ch t·ª´ kho·∫£n ƒë√≥ng g√≥p c·ªßa c√°c anh ch·ªã ƒë√¢u nh√©! üòä</p>
                </div>
            </div>

            <h2 class="text-center mb-5 fw-bold">üéÅ G√≥i ·ªßng h·ªô</h2>
            <div class="row row-cols-1 row-cols-md-3 mb-3 text-center">
                
                <div class="col">
                    <div class="card mb-4 rounded-3 shadow-sm pricing-card h-100">
                        <div class="card-header py-3 bg-light border-0 pricing-header">
                            <h4 class="my-0 fw-normal">G√≥i C∆° B·∫£n</h4>
                        </div>
                        <div class="card-body">
                            <h1 class="card-title pricing-card-title">450k<small class="text-muted fw-light">/3 th√°ng</small></h1>
                            <ul class="list-unstyled mt-3 mb-4 feature-list text-start ps-4">
                                <li>ü•§ Tr√† s·ªØa: <strong>45 ly</strong></li>
                                <li>üç± C∆°m vƒÉn ph√≤ng: <strong>60 b·ªØa</strong></li>
                                <li>‚õΩ XƒÉng xe: <span class="text-muted">Kh√¥ng</span></li>
                                <li>üì∫ Netflix: <strong>D√πng chung</strong></li>
                                <li>üì∏ ·∫¢nh c·∫≠p nh·∫≠t: C√≥ th·ªÉ c√≥</li>
                            </ul>
                            <button type="button" class="w-100 btn btn-lg btn-outline-primary" onclick="showDonateInfo(450000, '450.000ƒë')">Ch·ªçn g√≥i n√†y</button>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card mb-4 rounded-3 shadow pricing-card border-primary h-100 position-relative">
                        <div class="popular-badge">Ph·ªï bi·∫øn nh·∫•t</div>
                        <div class="card-header py-3 bg-primary text-white border-0 pricing-header">
                            <h4 class="my-0 fw-normal">G√≥i Ti√™u Chu·∫©n</h4>
                        </div>
                        <div class="card-body">
                            <h1 class="card-title pricing-card-title">1.45tr<small class="text-muted fw-light">/nƒÉm</small></h1>
                            <ul class="list-unstyled mt-3 mb-4 feature-list text-start ps-4">
                                <li>ü•§ Tr√† s·ªØa: <strong>Kh√¥ng gi·ªõi h·∫°n</strong></li>
                                <li>üç± C∆°m vƒÉn ph√≤ng: <strong>365 b·ªØa</strong></li>
                                <li>‚õΩ XƒÉng xe: <strong>5 tri·ªáu/nƒÉm</strong></li>
                                <li>üì∫ Netflix Premium: <strong>C√≥</strong></li>
                                <li>üì∏ ·∫¢nh c·∫≠p nh·∫≠t: M·ªói th√°ng</li>
                                <li>üîë M√£ Nu√¥i T√¥i (NT): <strong>ƒê·ªôc quy·ªÅn*</strong></li>
                            </ul>
                            <button type="button" class="w-100 btn btn-lg btn-primary" onclick="showDonateInfo(1450000, '1.450.000ƒë')">Ch·ªçn g√≥i n√†y</button>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card mb-4 rounded-3 shadow-sm pricing-card h-100">
                        <div class="card-header py-3 bg-dark text-white border-0 pricing-header">
                            <h4 class="my-0 fw-normal">G√≥i VIP üëë</h4>
                        </div>
                        <div class="card-body">
                            <h1 class="card-title pricing-card-title">5tr<small class="text-muted fw-light">/nƒÉm</small></h1>
                            <ul class="list-unstyled mt-3 mb-4 feature-list text-start ps-4">
                                <li>‚úÖ <strong>T·∫•t c·∫£ g√≥i Ti√™u Chu·∫©n</strong></li>
                                <li>‚òï Cafe Starbucks: <strong>M·ªói ng√†y</strong></li>
                                <li>üçΩÔ∏è ƒÇn nh√† h√†ng: <strong>2 l·∫ßn/th√°ng</strong></li>
                                <li>‚úàÔ∏è Du l·ªãch: <strong>1 chuy·∫øn/nƒÉm</strong></li>
                                <li>‚≠ê T√™n tr√™n website: <strong>C√≥ th·ªÉ</strong></li>
                                <li>üìπ Video call: M·ªói qu√Ω</li>
                            </ul>
                            <button type="button" class="w-100 btn btn-lg btn-outline-dark" onclick="showDonateInfo(5000000, '5.000.000ƒë')">Ch·ªçn g√≥i n√†y</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="alert alert-warning text-center shadow-sm mt-4" role="alert">
                <h4 class="alert-heading"><i class="fa-solid fa-lock"></i> B√°o c√°o t√†i ch√≠nh minh b·∫°ch</h4>
                <p>Ch√∫ng t√¥i cam k·∫øt c√¥ng khai 100% thu chi (sau 15 ng√†y ƒë√≥ng bƒÉng t√†i kho·∫£n ƒë·ªÉ ki·ªÉm tra).</p>
                <hr>
                <p class="mb-0 small"><strong>üîí Th√¥ng b√°o quan tr·ªçng:</strong> ƒê·ªÉ ƒë·∫£m b·∫£o t√≠nh minh b·∫°ch v√† ch√≠nh x√°c, t√†i kho·∫£n hi·ªán ƒëang ƒë∆∞·ª£c ƒë√≥ng bƒÉng trong 15 ng√†y ƒë·ªÉ th·ªëng k√™ thu-chi. Ch√∫ng t√¥i ƒëang l√†m vi·ªác v·ªõi b√™n th·ª© ba ƒë·ªôc l·∫≠p (c√≥ th·ªÉ l√† b·∫°n t√¥i) ƒë·ªÉ ki·ªÉm to√°n. C·∫£m ∆°n s·ª± ki√™n nh·∫´n c·ªßa qu√Ω v·ªã!</p>
            </div>

            <div class="modal fade" id="donateModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header bg-success text-white">
                            <h5 class="modal-title">üíñ Th√¥ng tin chuy·ªÉn kho·∫£n</h5>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-center">
                            <p>B·∫°n ƒë√£ ch·ªçn g√≥i: <strong id="selectedPackagePrice" class="text-danger fs-4"></strong></p>
                            
                            <div class="mb-3">
                                <label for="donorNameInput" class="form-label small text-muted">Nh·∫≠p t√™n/l·ªùi nh·∫Øn c·ªßa b·∫°n (ƒë·ªÉ in l√™n sao k√™):</label>
                                <input type="text" class="form-control text-center fw-bold" id="donorNameInput" placeholder="VD: Anh A dep trai" oninput="updateVietQR()">
                                <div class="form-text text-primary" id="previewContent">N·ªôi dung CK: NUOI EM</div>
                            </div>

                            <div class="p-3 bg-light rounded border mb-3 position-relative">
                                <div id="qrLoader" class="d-none">
                                    <div class="spinner-border text-primary" role="status"></div>
                                    <p class="small text-muted mt-2">ƒêang t·∫°o m√£ QR...</p>
                                </div>
                                
                                <img id="vietqrImage" src="" class="img-fluid shadow-sm border" alt="Qu√©t m√£ QR ƒë·ªÉ thanh to√°n" style="min-height: 300px; width: 100%; object-fit: contain;">
                                
                                <p class="mt-3 mb-1 fw-bold">Ng√¢n h√†ng: Vietinbank</p>
                                <p class="mb-1 fs-5 text-primary copy-text" role="button" onclick="copyToClipboard('100872675193')">
                                    STK: 100872675193 <i class="fa-regular fa-copy"></i>
                                </p>
                                <p class="mb-0">T√™n: NGUYEN QUANG DUY</p>
                            </div>
                            
                            <div class="alert alert-info py-2 small">
                                <i class="fa-solid fa-check-circle"></i> H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông nh·∫≠n di·ªán giao d·ªãch c·ªßa b·∫°n.
                            </div>
                        </div>
                        <div class="modal-footer justify-content-center">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                        </div>
                    </div>
                </div>
            </div>

        </section>

    </div>

    <footer class="text-center py-4 text-muted bg-white border-top mt-5">
        <small>¬© 2025 WWM Patcher & Project "Nu√¥i T√¥i". Admin li√™n t·ª•c c·∫≠p nh·∫≠t link m·ªõi. F5 ƒë·ªÉ l√†m m·ªõi danh s√°ch.</small>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Logic l·ªçc game (Gi·ªØ nguy√™n)
        function filterVersions() {
            const platform = document.getElementById('platformSelect').value;
            let targetKey = "";
            if (platform === "Launcher") {
                document.getElementById('launcherOptions').classList.remove('hidden');
                const clientType = document.querySelector('input[name="clientType"]:checked').value;
                targetKey = clientType;
            } else {
                document.getElementById('launcherOptions').classList.add('hidden');
                targetKey = platform;
            }
            const items = document.querySelectorAll('.item-row');
            let hasItem = false;
            items.forEach(item => {
                const itemPlatform = item.getAttribute('data-platform');
                if (itemPlatform.toLowerCase() === targetKey.toLowerCase()) {
                    item.classList.remove('hidden');
                    hasItem = true;
                } else {
                    item.classList.add('hidden');
                }
            });
            const alertBox = document.getElementById('noDataAlert');
            alertBox.classList.toggle('hidden', hasItem);
        }
        
        // Copy STK
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text);
            alert("ƒê√£ copy s·ªë t√†i kho·∫£n: " + text);
        }
        
        // Load top donors v√† hi·ªÉn th·ªã trong banner
        async function loadTopDonors() {
            try {
                const response = await fetch('/api/top-donors');
                const data = await response.json();
                
                if (data.success && data.top_donors.length > 0) {
                    const marqueeContent = document.getElementById('marqueeContent');
                    const banner = document.getElementById('topDonorsBanner');
                    
                    // T·∫°o n·ªôi dung cho banner
                    let content = '';
                    data.top_donors.forEach(donor => {
                        content += `
                            <span class="donor-highlight">
                                <span class="donor-rank">Top ${donor.rank}</span>
                                ${donor.email} - ${donor.total_donated.toLocaleString()}ƒë
                            </span>
                        `;
                    });
                    
                    // L·∫∑p l·∫°i n·ªôi dung ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng cu·ªôn li√™n t·ª•c
                    marqueeContent.innerHTML = content + content;
                    banner.classList.remove('d-none');
                }
            } catch (error) {
                console.error('L·ªói khi load top donors:', error);
            }
        }
        
        // --- LOGIC VIETQR M·ªöI ---
        const BANK_ID = "Vietinbank";
        const ACCOUNT_NO = "100872675193";
        const TEMPLATE = "compact2";
        
        // Bi·∫øn l∆∞u s·ªë ti·ªÅn hi·ªán t·∫°i ƒëang ch·ªçn
        let currentAmount = 0;

        // H√†m hi·ªÉn th·ªã Modal v√† t·∫°o QR ban ƒë·∫ßu
        function showDonateInfo(amount, displayString) {
            // 1. L∆∞u s·ªë ti·ªÅn v√† c·∫≠p nh·∫≠t giao di·ªán text
            currentAmount = amount;
            document.getElementById('selectedPackagePrice').innerText = displayString;
            
            // 2. Reset √¥ nh·∫≠p t√™n
            document.getElementById('donorNameInput').value = "";
            
            // 3. T·∫°o m√£ QR ngay l·∫≠p t·ª©c (v·ªõi n·ªôi dung m·∫∑c ƒë·ªãnh)
            updateVietQR();

            // 4. Hi·ªÉn th·ªã Modal
            var myModal = new bootstrap.Modal(document.getElementById('donateModal'));
            myModal.show();
        }

        // H√†m c·∫≠p nh·∫≠t ·∫£nh QR khi ng∆∞·ªùi d√πng g√µ t√™n
        function updateVietQR() {
            // L·∫•y t√™n ng∆∞·ªùi d√πng nh·∫≠p (n·∫øu tr·ªëng th√¨ ƒë·ªÉ r·ªóng)
            const name = document.getElementById('donorNameInput').value.trim();
            
            // T·∫°o n·ªôi dung chuy·ªÉn kho·∫£n: "NUOI EM" + T√™n
            // L∆∞u √Ω: C·∫ßn x·ª≠ l√Ω ti·∫øng Vi·ªát kh√¥ng d·∫•u ho·∫∑c URL Encode ƒë·ªÉ tr√°nh l·ªói QR
            let description = "NUOI EM";
            if (name) {
                description += " " + removeVietnameseTones(name).toUpperCase();
            }

            // C·∫≠p nh·∫≠t text xem tr∆∞·ªõc
            document.getElementById('previewContent').innerText = "N·ªôi dung CK: " + description;

            // T·∫°o Link API VietQR
            // C·∫•u tr√∫c: https://img.vietqr.io/image/<BANK>-<ACC>-<TEMPLATE>.png?amount=<AMT>&addInfo=<MSG>
            const qrUrl = `https://img.vietqr.io/image/${BANK_ID}-${ACCOUNT_NO}-${TEMPLATE}.png?amount=${currentAmount}&addInfo=${encodeURIComponent(description)}`;
            
            // G√°n v√†o th·∫ª ·∫£nh
            document.getElementById('vietqrImage').src = qrUrl;
        }

        // H√†m ph·ª• tr·ª£: Chuy·ªÉn ti·∫øng Vi·ªát c√≥ d·∫•u th√†nh kh√¥ng d·∫•u (ƒë·ªÉ ng√¢n h√†ng d·ªÖ ƒë·ªçc)
        function removeVietnameseTones(str) {
            str = str.replace(/√†|√°|·∫°|·∫£|√£|√¢|·∫ß|·∫•|·∫≠|·∫©|·∫´|ƒÉ|·∫±|·∫Ø|·∫∑|·∫≥|·∫µ/g,"a"); 
            str = str.replace(/√®|√©|·∫π|·∫ª|·∫Ω|√™|·ªÅ|·∫ø|·ªá|·ªÉ|·ªÖ/g,"e"); 
            str = str.replace(/√¨|√≠|·ªã|·ªâ|ƒ©/g,"i"); 
            str = str.replace(/√≤|√≥|·ªç|·ªè|√µ|√¥|·ªì|·ªë|·ªô|·ªï|·ªó|∆°|·ªù|·ªõ|·ª£|·ªü|·ª°/g,"o"); 
            str = str.replace(/√π|√∫|·ª•|·ªß|≈©|∆∞|·ª´|·ª©|·ª±|·ª≠|·ªØ/g,"u"); 
            str = str.replace(/·ª≥|√Ω|·ªµ|·ª∑|·ªπ/g,"y"); 
            str = str.replace(/ƒë/g,"d");
            str = str.replace(/√Ä|√Å|·∫†|·∫¢|√É|√Ç|·∫¶|·∫§|·∫¨|·∫®|·∫™|ƒÇ|·∫∞|·∫Æ|·∫∂|·∫≤|·∫¥/g, "A");
            str = str.replace(/√à|√â|·∫∏|·∫∫|·∫º|√ä|·ªÄ|·∫æ|·ªÜ|·ªÇ|·ªÑ/g, "E");
            str = str.replace(/√å|√ç|·ªä|·ªà|ƒ®/g, "I");
            str = str.replace(/√í|√ì|·ªå|·ªé|√ï|√î|·ªí|·ªê|·ªò|·ªî|·ªñ|∆†|·ªú|·ªö|·ª¢|·ªû|·ª†/g, "O");
            str = str.replace(/√ô|√ö|·ª§|·ª¶|≈®|∆Ø|·ª™|·ª®|·ª∞|·ª¨|·ªÆ/g, "U");
            str = str.replace(/·ª≤|√ù|·ª¥|·ª∂|·ª∏/g, "Y");
            str = str.replace(/ƒê/g, "D");
            return str;
        }
        
        // Ch·∫°y l·ªçc l·∫ßn ƒë·∫ßu v√† load top donors
        window.onload = function() {
            filterVersions();
            loadTopDonors();
        };
    </script>
</body>
</html>